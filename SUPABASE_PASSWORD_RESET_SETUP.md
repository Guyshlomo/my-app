# מדריך הגדרת איפוס סיסמא ב-Supabase

## 🎯 מטרה
להגדיר את איפוס הסיסמא כך שיעבוד גם באפליקציה וגם בדפדפן.

## 📋 שלבים לביצוע

### שלב 1: כניסה ל-Supabase Dashboard

1. היכנס ל: https://supabase.com/dashboard
2. בחר את הפרויקט שלך: `oomibleqeelsswfbkjou`

### שלב 2: הגדרת Redirect URLs

1. בתפריט הצדדי, לחץ על **Authentication**
2. לחץ על **URL Configuration**
3. בחלק **Redirect URLs**, הוסף את ה-URLs הבאים:

```
# לאפליקציה (deep link)
voluntree://reset-password

# לדפדפן (fallback)
https://oomibleqeelsswfbkjou.supabase.co/auth/v1/verify

# לאפליקציה (OAuth)
voluntree://auth/callback
```

4. לחץ על **Save** לשמירת השינויים

### שלב 3: הגדרת Email Templates

1. ב-Authentication, לחץ על **Email Templates**
2. בחר **Password Reset**
3. ערוך את התבנית:

**Subject (נושא):**
```
איפוס סיסמא - Voluntree
```

**Body (תוכן):**
```html
<h2>שלום!</h2>
<p>קיבלנו בקשה לאיפוס הסיסמא שלך ב-Voluntree.</p>
<p>לחץ על הקישור למטה כדי לאפס את הסיסמא שלך:</p>
<p><a href="{{ .ConfirmationURL }}">איפוס סיסמא</a></p>
<p>אם לא ביקשת לאפס את הסיסמא, תוכל להתעלם מהמייל הזה.</p>
<p>הקישור תקף ל-24 שעות.</p>
<br>
<p>בברכה,<br>צוות Voluntree</p>
```

4. לחץ על **Save** לשמירת התבנית

### שלב 4: הגדרת Site URL

1. ב-Authentication, לחץ על **General**
2. בחלק **Site URL**, הזן:
```
https://oomibleqeelsswfbkjou.supabase.co
```https://oomibleqeelsswfbkjou.supabase.co

### שלב 5: בדיקת הגדרות SMTP (אופציונלי)

1. ב-Authentication, לחץ על **SMTP Settings**
2. וודא שהגדרות ה-SMTP נכונות
3. אם לא מוגדר, השתמש בהגדרות ברירת המחדל של Supabase

## 🔧 מה קורה עכשיו?

### כשמשתמש לוחץ "שכחתי סיסמא":

1. **האפליקציה** שולחת בקשה ל-Supabase עם ה-email
2. **Supabase** שולח מייל עם קישור ל: `https://oomibleqeelsswfbkjou.supabase.co/auth/v1/verify`
3. **הקישור** מכיל פרמטרים של `access_token` ו-`refresh_token`

### כשמשתמש לוחץ על הקישור:

#### אם האפליקציה מותקנת:
- הקישור ינסה לפתוח את האפליקציה עם `voluntree://reset-password`
- האפליקציה תזהה את הקישור ותפתח את מסך איפוס הסיסמא

#### אם האפליקציה לא מותקנת:
- הקישור יפתח בדפדפן
- יוצג עמוד איפוס סיסמא מותאם אישית (הקובץ שיצרנו)
- המשתמש יוכל להגדיר סיסמה חדשה בדפדפן

## 🧪 בדיקה

### בדיקת האפליקציה:
1. פתח את האפליקציה
2. לחץ על "שכחתי סיסמא"
3. הזן email קיים
4. בדוק את המייל שנשלח
5. לחץ על הקישור מהמייל
6. וודא שהאפליקציה נפתחת עם מסך איפוס סיסמא

### בדיקת הדפדפן:
1. פתח את הקישור מהמייל בדפדפן
2. וודא שמופיע עמוד איפוס סיסמא
3. נסה להגדיר סיסמה חדשה
4. וודא שהסיסמה משתנה בהצלחה

## 🐛 פתרון בעיות

### המייל לא נשלח:
- בדוק הגדרות SMTP
- בדוק שהמייל קיים במערכת
- בדוק logs ב-Supabase Dashboard

### הקישור לא עובד:
- וודא שה-Redirect URLs מוגדרים נכון
- בדוק שה-Site URL נכון
- וודא שהאפליקציה מותקנת (לבדיקת deep link)

### עמוד איפוס סיסמא לא מופיע:
- וודא שקובץ `public/reset-password.html` קיים
- בדוק שה-URL נכון
- בדוק console logs בדפדפן

## 📱 הערות חשובות

1. **Deep Links** עובדים רק כשהאפליקציה מותקנת
2. **Web Fallback** עובד תמיד, גם בלי אפליקציה
3. **הקישור תקף ל-24 שעות** (ברירת מחדל של Supabase)
4. **הסיסמה חייבת להיות לפחות 6 תווים**

## ✅ סיכום

לאחר ביצוע כל השלבים:
- ✅ איפוס סיסמא יעבוד באפליקציה
- ✅ איפוס סיסמא יעבוד בדפדפן
- ✅ המשתמשים יקבלו מייל ברור
- ✅ החוויה תהיה חלקה בשני המקרים

---

**הערה**: אם יש בעיות, בדוק את ה-logs ב-Supabase Dashboard או ב-console של הדפדפן/אפליקציה. 